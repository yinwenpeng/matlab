
%TE-unigram
% a=[ 0.31274732979  0.2533063   0.2938233   0.23882733  0.29927314  0.31225405 0.25207656; 
%     0.31103597  0.29112779  0.26995891  0.24689582  0.29229067  0.31103597 0.24350848;
%   0.30163389  1.          0.26452844  0.24426621  0.29411127  0.30163389 0.24103443;
%   0.34674483  0.26452844  1.          0.25603874  0.33089934  0.34674483 0.25904018;
%   0.28493063  0.24426621  0.25603874  1.          0.27765048  0.28493063 0.23745793;
%   0.4293389   0.29411127  0.33089934  0.27765048  1.          0.4293389 0.28911921;
%   0.31225405  0.2533063   0.2938233   0.23882733  0.29927314  1. 0.25207656;
%   0.3058882   0.24103443  0.25904018  0.23745793  0.28911921  0.3058882 1.        ];
%TE-phrase
% a=[ 0.37539511  0.21159797  0.19193056  0.16709504  0.18124507  0.16929919 0.20952532  0.2284134   0.25207656;
%   0.2324931   0.21368331  0.1987648   0.16945286  0.17224907  0.163794 0.19532316  0.20544816  0.20981926;
%   0.18687498  0.2324931   0.22078362  0.17842787  0.15524771  0.15304362 0.17232942  0.1744537   0.16744548;
%  0.18487411  0.22594515  0.25201871  0.20415615  0.1720179   0.15316514 0.16910996  0.1707975   0.16951589;
%   0.17554001  0.19735043  0.21390783  1.          0.29411127  0.228482 0.16413721  0.16559899  0.15969599;
%   0.18631753  0.17287671  0.18353643  0.29411127  1.          0.26710301 0.18101989  0.17537855  0.17383856;
%   0.21050703  0.20033747  0.19003991  0.228482    0.26710301  1. 0.20300055  0.19464851  0.16059583;
%   0.26330464  0.22984548  0.20989336  0.16413721  0.18101989  0.20300055 1.          0.42959986  0.25233316;
%  0.30537762  0.24103443  0.21046383  0.16559899  0.17537855  0.19464851 0.42959986  1.          0.29455138;
%   0.23675061  0.18973881  0.16910256  0.15969599  0.17383856  0.16059583 0.25233316  0.29455138  1.        ];
%QA-unigram
% a=[ 0.10767853  0.19818328  0.21426055  0.23661825  0.20457423  0.18790396 0.18406771  0.1921572   0.19453012  0.21060547;
%   0.13256969  0.20805561  0.22857438  0.335099    0.23123642  0.29618432 0.21112282  0.19507173  0.19248566  0.21920242;
%   0.11155658  0.20055781  0.31458132  0.23329257  0.20481006  0.18450997 0.29459649  0.18458415  0.18731105  0.21222948;
%   0.20796545  0.1945021   0.18288069  0.19615332  0.21708277  0.16925429 0.20593638  0.15902871  0.16044607  0.18523123;
%  0.25711797  0.19981121  0.49831252  0.29570005  0.25816242  0.19656272 0.24971241  0.17957121  0.17805465  0.19621662];
%QA-phrase not good
% a=[ 0.10767853  0.12776154  0.16507957  0.14695931  0.14784355  0.13270792 0.14782871  0.14719778  0.11644541  0.12125663  0.12286171  0.15670602  0.21060547;
%   0.22425682  0.17464619  0.25578999  0.1429666   0.14180088  0.12815582  0.13958931  0.13674331  0.111121    0.11501276  0.11557506  0.14190403  0.17730545;
%   0.1748516   0.15047747  0.14009622  0.13121815  0.12852081  0.11683187  0.12514277  0.1213038   0.1024134   0.10631966  0.10594374  0.12625439  0.14894877;
%   0.1364129   0.1330833   0.12870012  0.12407629  0.12225885  0.10849973  0.1128287   0.1070204   0.09305334  0.09610098  0.09591474  0.11150939   0.12704365;
%   0.13401516  0.13543409  0.13098595  0.12961012  0.12783713  0.11360755  0.11884623  0.10970413  0.09424232  0.09509713  0.09475043  0.10978776  0.12574408;
%   0.14952892  0.14948827  0.14001072  0.13601167  0.13559849  0.11900778  0.12647225  0.11689885  0.09866523  0.09980435  0.0998967   0.11821679  0.13901968;
%   0.16431322  0.16226579  0.14781153  0.14239553  0.14440169  0.12640751  0.13558338  0.12582085  0.10386002  0.10431276  0.1051977   0.12598118  0.15213308;
%  0.25711797  0.19812578  0.16565034  0.15318334  0.15475393  0.14008783   0.1589887   0.1514127   0.11736596  0.11768969  0.11881171  0.14860003   0.19621662];

%PI-unigram
% a=[1. 0.1789018 0.23618484 0.20747644 0.28224816 0.22094698 0.26236271 0.26725906 0.18438991 0.23618484 0.24659135;
%   0.21116221  0.23873668  0.23400122  0.19458241  0.22931903  0.2000947...
%    0.21572925  0.26528572  0.16935752  0.23400122  0.19929995;
%   0.23618484  0.19558243  1.          0.2048257   0.26980464  0.21144087...
%    0.24022279  0.27430271  0.17938348  1.          0.22835991;
%   0.23452068  0.19297827  0.22483811  0.27772814  0.27258448  0.19791129...
%    0.23210382  0.25376695  0.17558403  0.22483811  0.23039085;
%   0.28224816  0.19915496  0.26980464  0.23632697  1.          0.22944282...
%    0.27212515  0.3133782   0.19632035  0.26980464  0.25642239;
%   0.22094698  0.17228836  0.21144087  0.18688088  0.22944282  1....
%    0.21675914  0.23151524  0.17340179  0.21144087  0.21011192;
%   0.26236271  0.18319732  0.24022279  0.2085449   0.27212515  0.21675914...
%    1.          0.26617668  0.18555612  0.24022279  0.2419879 ;
%   0.26725906  0.21626581  0.27430271  0.22274262  0.3133782   0.23151524...
%    0.26617668  1.          0.20059194  0.27430271  0.25396013;
%   0.24764022  0.18168939  0.23410828  0.21178516  0.27748585  0.20909392...
%    0.23854179  0.26523247  0.17799597  0.23410828  0.2308408 ;
%   0.23618484  0.19558243  1.          0.2048257   0.26980464  0.21144087...
%    0.24022279  0.27430271  0.17938348  1.          0.22835991;
%   0.24659135  0.19078333  0.22835991  0.20864818  0.25642239  0.21011192...
%    0.2419879   0.25396013  0.19423667  0.22835991  1.;
%  0.1051897   0.10108419  0.10654924  0.10088259  0.20908652  0.10803439 0.10577474  0.20082345  0.10169727  0.10654924  0.10723179];
%new unigram
% a=[0.256566439544 0.9999900001 0.271502253734 0.307600519203 0.256802007904 0.322521969851 0.322521969851 0.243273888877 0.265120240841;
% 0.27220346515 0.271502253734 0.9999900001 0.295371406202 0.249856315964 0.306204916108 0.306204916108 0.232604485395 0.249477170521;
% 0.232050611904 0.239171870783 0.223137533945 0.254665136196 0.245565894488 0.265628850673 0.265628850673 0.219717771246 0.240667412774;
% 0.27105176516 0.274435266109 0.257568236169 0.352947406096 0.322267502228 0.328748785669 0.328748785669 0.245053332627 0.282027050445;
% 0.31699422751 0.313360857884 0.307095532903 0.461030211553 0.331020450607 0.479910496895 0.379910496895 0.273691498318 0.317203902418;
% 0.262461504861 0.265120240841 0.249477170521 0.297930818819 0.263119163511 0.313267295546 0.313267295546 0.231993952935 0.9999900001;
% 0.310843546772 0.32176882836 0.29857978355 0.39484189369 0.302804420308 0.439186040852 0.339186040852 0.26374792545 0.308908107761;
% 0.277955884202 0.263861146434 0.260383908614 0.325877567501 0.26678433401 0.330282332964 0.330282332964 0.237265278045 0.266395641588;
% 0.9999900001 0.256566439544 0.27220346515 0.306905954567 0.262727036926 0.318144461035 0.318144461035 0.243121154974 0.262461504861;
% 0.206498713666 0.210631159949 0.202916198569 0.219091483571 0.209887137084 0.229094170281 0.229094170281 0.229347474194 0.225366865751;
% 0.282655005478 0.287105056341 0.278428728448 0.380689658724 0.309843989525 0.382960590584 0.322960590584 0.255318852802 0.28113400913;
% 0.283564977433 0.312337549869 0.277438594382 0.356832360749 0.29295318982 0.394890157459 0.204890157459 0.254999738172 0.29937692196];
% [m n]=find(a);
% for ii=1:length(m)
%     x=n(ii)+[1 2 2 1];
%     y=m(ii)+[1 1 2 2];
%     patch(x,y,'b','facealpha',mod(1.95*a(m(ii),n(ii)),1)-0.15);
%     %patch(x,y,'b','facealpha',mod(1.95*a(m(ii),n(ii)),1));%origin for
%     %paper
%     
% end
% v1=[0.0946194783366; 0.0927980300789; 0.0637297388972; 0.0776232650687; 0.0956198752693; 0.0931831810073; 0.089779547619; 0.0745986213031; 0.0944552209468; 0.0571910980657; 0.0808192876564; 0.0705826557511];
% [m n]=find(v1);
% for ii=1:length(m)
%     x=n(ii)+[-1 0 0 -1];
%     y=m(ii)+[1 1 2 2];
%     patch(x,y,'b','facealpha',10*v1(m(ii),n(ii))-0.15);
%     
% end
% v2=[0.115810026645 0.117063920205 0.113649547529 0.115254659978 0.0825939021745 0.119832905464 0.099832905464 0.0754148122901 0.116547320251];
% [m n]=find(v2);
% for ii=1:length(m)
%     x=n(ii)+[1 2 2 1];
%     y=m(ii)+[-1 -1 0 0];
%     patch(x,y,'b','facealpha',8*v2(m(ii),n(ii))-0.15);
%     
% end
% axis([0,11,0,14])
%new conv1
% a=[0.837635833732 0.842248917321 0.714563608864 0.694076376622 0.621497587738 0.636491907606 0.672633370367 0.663389109279 0.676663040079 0.639130895166 0.734648619224;
% 0.694749442687 0.616265774997 0.916446921097 0.793953766414 0.775833825865 0.802777328783 0.86732357916 0.823179277689 0.824213630512 0.809980545512 0.747903309019;
% 0.657386590644 0.633424797775 0.824432686886 0.896886315023 0.815272372249 0.780720923438 0.801659616993 0.847435934592 0.845364091655 0.821480556083 0.785338114295;
% 0.617785248536 0.575031042937 0.799776513831 0.837361600232 0.92205963008 0.846118277883 0.826426768949 0.871291061043 0.860504787132 0.881390103912 0.760047143028;
% 0.611649117666 0.572606846706 0.797883606625 0.836479234193 0.904139970639 0.830040562188 0.82388751161 0.867774338078 0.845391258897 0.891019202726 0.757250357611;
% 0.658522767145 0.606364923434 0.842311912033 0.905488054693 0.89419914581 0.872918585951 0.8771199193 0.907950076508 0.937166991523 0.893435943255 0.82635747669;
% 0.656689444862 0.601752976725 0.832324474999 0.902345395192 0.895073482811 0.87436960695 0.882364501274 0.91149783964 0.927505752041 0.903995549923 0.896070080255;
% 0.724902212103 0.648526244941 0.793198026512 0.840403075941 0.758585763479 0.770382640037 0.810288905431 0.808952174826 0.819605672739 0.783150338939 0.841288806931;
% 0.759324196765 0.67618891093 0.6801331068 0.697463875757 0.63569627005 0.649885565783 0.678490470516 0.673603455568 0.681488818409 0.652822248851 0.721672757771;
% 0.786260212232 0.760953161885 0.689900734978 0.699704339466 0.623060135044 0.629314556702 0.66599321998 0.668466726616 0.671087589698 0.643402782854 0.714617625829;
% 0.814297688288 0.782190934731 0.70379902951 0.714005627734 0.635967902469 0.64902388341 0.679655818237 0.676240585366 0.690911149166 0.651066263656 0.738080307045;
% 0.712221520816 0.647219546121 0.773243849893 0.814349236583 0.732313775387 0.727481008615 0.775762133952 0.79245548531 0.775220563779 0.764705965673 0.790458090326;
% 0.721069007187 0.653573289014 0.877683267878 0.886021165466 0.806167111089 0.828974168095 0.866176466745 0.855216319738 0.903012291401 0.820131487518 0.893378114132;
% 0.772725561927 0.69633508143 0.840811955599 0.83990604388 0.742815518651 0.761049440037 0.813344053527 0.80204611614 0.822684021812 0.768092254051 0.889983653109];
% [m n]=find(a);
% for ii=1:length(m)
%     x=n(ii)+[1 2 2 1];
%     y=m(ii)+[1 1 2 2];
%     %patch(x,y,'b','facealpha',mod(1.95*a(m(ii),n(ii)),1));
%     patch(x,y,'b','facealpha',2*(a(m(ii),n(ii))-0.55));
%     
% end
% v1=[0.0651212352346; 0.0738763564473; 0.0733439204816; 0.0740882749369; 0.0735857784108; 0.0776592458782; 0.0775931670441; 0.0724165897717; 0.0632162711403; 0.0636035755932; 0.0651402665824; 0.0699419872681; 0.0767292627292; 0.0706840684816];
% [m n]=find(v1);
% for ii=1:length(m)
%     x=n(ii)+[-1 0 0 -1];
%     y=m(ii)+[1 1 2 2];
%     patch(x,y,'b','facealpha',50*(v1(m(ii),n(ii))-0.06));
%     
% end
% v2=[0.0844247232794 0.0784242868839 0.0933621028814 0.0956521264523 0.0906350779133 0.0857665619662 0.0929799189487 0.0940609711053 0.0949984327351 0.0919919211556 0.0937038766786];
% [m n]=find(v2);
% for ii=1:length(m)
%     x=n(ii)+[1 2 2 1];
%     y=m(ii)+[-1 -1 0 0];
%     patch(x,y,'b','facealpha',50*(v2(m(ii),n(ii))-0.076));
%     
% end
% axis([0,13,0,16])
%new conv2
a=[0.928118403792 0.643125493972 0.515879071976 0.507322287793 0.505436126853 0.507127469845 0.505666999018 0.50283157489 0.50178548079 0.558020399831 0.674865253191;
0.728564018413 0.872915393585 0.644364261812 0.631419545108 0.627710099947 0.630299466438 0.628505896092 0.624354856515 0.622495584179 0.658217985026 0.640616309356;
0.586470951534 0.771727331961 0.829629504474 0.810023764942 0.80678199146 0.810244926884 0.80522329913 0.798466026414 0.796488254761 0.747168122452 0.595876775232;
0.579981227884 0.762104663663 0.842798016566 0.822800556038 0.819706729947 0.823232878027 0.817921567942 0.810965216462 0.809012446655 0.744063276182 0.590340763642;
0.576882146334 0.759198423311 0.850552461983 0.830163882575 0.826924650083 0.830538511582 0.825174744574 0.818091101169 0.816072787163 0.740693279909 0.586626589958;
0.574243622773 0.754704452993 0.85425300686 0.834132919969 0.831106816652 0.834623757958 0.829059215414 0.821992997256 0.820051925879 0.742009580589 0.585320254971;
0.578431885026 0.755066793157 0.836189762709 0.817870928928 0.815584758063 0.818624822195 0.812937311319 0.806356039513 0.804735326655 0.756881232463 0.594383570582;
0.591998575756 0.763703700964 0.802461613409 0.785575757303 0.783685260216 0.786430940814 0.781094409133 0.775028195499 0.773611381128 0.773525938379 0.612641468986;
0.610867718759 0.779718953682 0.770091228639 0.753879561571 0.751806986916 0.754502342756 0.749765168774 0.744051518155 0.742613933317 0.777403462341 0.63142065337;
0.621765663569 0.794757917741 0.759451559657 0.742980880213 0.740509970561 0.743355354466 0.739014809603 0.733320435915 0.731740650839 0.766642019873 0.635926731459;
0.617133683571 0.801894571127 0.773467016739 0.755918767791 0.752929112841 0.756053531056 0.75181215194 0.745832465218 0.744032382291 0.755178377389 0.624541888144;
0.601866292823 0.790682510455 0.801344375009 0.782573562411 0.77928963406 0.782646223262 0.778131286945 0.771740409418 0.769789091852 0.7502204597 0.608918597961;
0.621140743333 0.676074865767 0.626691503612 0.618554979047 0.61837285034 0.619291035208 0.615585735761 0.612472239937 0.612052344703 0.828156086172 0.74538259893;
0.682434221061 0.589234742022 0.514741129904 0.507747825948 0.5072610627 0.50833069166 0.505996822326 0.503465468459 0.502985054991 0.621516769963 0.904022573773];
[m n]=find(a);

for ii=1:length(m)
    x=n(ii)+[1 2 2 1];
    y=m(ii)+[1 1 2 2];
    %patch(x,y,'b','facealpha',mod(2*(a(m(ii),n(ii))-0.5),1));
    %patch(x,y,'b','facealpha',2*(a(m(ii),n(ii))-0.50));%paper version
    temp=exp(10*(a(m(ii),n(ii))-0.50));
    patch(x,y,'b','facealpha',(exp(temp)-1)/(exp(temp)+1));
    
end
v1=[0.057769333326; 0.0664962133617; 0.0760359594614; 0.0766257031219; 0.0769713199157; 0.0771585416276; 0.0763904028494; 0.0748683812027; 0.073379741793; 0.0728643307036; 0.0714950263063; 0.0707541667306; 0.065443763636; 0.0577471159639];
[m n]=find(v1);
for ii=1:length(m)
    x=n(ii)+[-1 0 0 -1];
    y=m(ii)+[1 1 2 2];
    patch(x,y,'b','facealpha',40*(v1(m(ii),n(ii))-0.057));
    
end
v2=[0.0809648478095 0.0956570471264 0.0948110431137 0.0928010061877 0.0924929799486 0.0928404586446 0.0922999663643 0.0916001958748 0.0914045871382 0.0929714142937 0.0821564534985];
[m n]=find(v2);
for ii=1:length(m)
    x=n(ii)+[1 2 2 1];
    y=m(ii)+[-1 -1 0 0];
    patch(x,y,'b','facealpha',50*(v2(m(ii),n(ii))-0.08));
    
end
axis([0,13,0,16])
set(gca,'ydir','reverse','xaxislocation','top');
%set(gca,'xtick',[2.5 3.5 4.5 5.5 6.5 7.5 8.5 9.5 10.5],'xticklabel',{'several' 'people' 'are' 'in' 'front' 'of' 'a' 'colorful' 'building'});
%set(gca,'xtick',[2.5 3.5 4.5 5.5 6.5 7.5 8.5 9.5 10.5 11.5 12.5],'xticklabel',{'several' 'several people' 'several people are' ' people are in' 'are in front' 'in front of' 'front of a' 'of a colorful' 'a corlorful building' 'corlorful building' 'building'});
set(gca,'xtick',[2.5 3.5 4.5 5.5 6.5 7.5 8.5 9.5 10.5 11.5 12.5],'xticklabel',{'several' 'several people' 'several...are' 'several...in' 'several...front' 'people...of' 'are...a' 'in...colorful' 'front...building' 'of...building' 'a...building'});
ax = gca; 
ax.XTickLabelRotation = 45;
%set(gca,'ytick',[2.5 3.5 4.5 5.5 6.5 7.5 8.5 9.5 10.5 11.5 12.5 13.5],'yticklabel',{'people' 'are' 'walking' 'outside' 'the' 'building' 'that' 'has' 'several' 'murals' 'on' 'it'});
%set(gca,'ytick',[2.5 3.5 4.5 5.5 6.5 7.5 8.5 9.5 10.5 11.5 12.5 13.5 14.5 15.5],'yticklabel',{'people' 'people are' 'people are walking' 'are walking outside' 'walking outside the' 'outside the building' 'the building that' 'building that has' 'that has several' 'has several murals' 'several murals on' 'murals on it' 'on it' 'it'});
set(gca,'ytick',[2.5 3.5 4.5 5.5 6.5 7.5 8.5 9.5 10.5 11.5 12.5 13.5 14.5 15.5],'yticklabel',{'people' 'people are' 'people...walking' 'people...outside' 'people...the' 'are...building' 'walking...that' 'outside...has' 'the...several' 'building...murals' 'that...on' 'has...it' 'several...it' 'murals...it'});
set(gca,'FontSize',11)
% ay = gca; 
% ay.YTickLabelRotation = -45;
% set(gca,'xtick',[0.5 1.5 2.5 3.5 4.5 5.5 6.5 7.5 8.5 9.5],'xticklabel',{'the' 'movie' 'earned' '$' '161.5' 'million' 'in' 'north' 'acmerica' 'alone'});
% set(gca,'ytick',[0.5 1.5 2.5 3.5 4.5],'yticklabel',{'how' 'much' 'did' 'waterboy' 'gross'});
% set(gca,'xtick',[0.5 1.5 2.5 3.5 4.5 5.5 6.5 7.5 8.5 9.5 10.5],'xticklabel',{'she' 'signed' 'a' 'contract' 'with' 'random' 'house' 'to' 'write' 'a' 'book'});
% set(gca,'ytick',[0.5 1.5 2.5 3.5 4.5  5.5 6.5 7.5 8.5 9.5 10.5 11.5],'yticklabel',{'she' 'struck' 'a' 'deal' 'with' 'random' 'house' 'to' 'open' 'a' 'book' 'today'});